[{"id":"f02f2c4d.a3a5","type":"inject","z":"cead70f3.3f516","name":"Gate Open","topic":"","payload":"Open","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":40,"wires":[["f696a868.ae0be8"]]},{"id":"f696a868.ae0be8","type":"ui_button","z":"cead70f3.3f516","name":"Gate Open","group":"a3f313e.1af68f","order":0,"width":"2","height":"1","passthru":true,"label":"Open","color":"White","bgcolor":"Red","icon":"ui_switch","payload":"Open","payloadType":"str","topic":"","x":310,"y":40,"wires":[["f0695def.ba6f9","8c5452b8.3a682"]]},{"id":"27f48b88.d54724","type":"rpi-gpio out","z":"cead70f3.3f516","name":"Pin 37 - Gate Control","pin":"37","set":"","level":"0","freq":"","out":"out","x":1000,"y":60,"wires":[]},{"id":"7d024680.5bc2c8","type":"trigger","z":"cead70f3.3f516","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","name":"","x":780,"y":60,"wires":[["27f48b88.d54724"]]},{"id":"ad55cf7.db5c13","type":"ui_template","z":"cead70f3.3f516","group":"be12b1fc.f2ab","name":"","order":1,"width":"0","height":"0","format":"<iframe id=\"camframe\" src=\"https://captiveye-kirribilli.qnetau.com/stream_scaling/public/default_iframe_n.asp?wmode=transparent\" scrolling=\"no\" allowfullscreen=\"\" wmode=\"transparent\" onload=\"resetHeight('camframe')\" style=\"height: 200px;\" width=\"100%\" height=\"850px\" frameborder=\"0\" align=\"middle\"></iframe>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":960,"y":420,"wires":[[]]},{"id":"ca4c0ea.3ea89f","type":"rpi-gpio in","z":"cead70f3.3f516","name":"Gate Sensor","pin":"38","intype":"up","debounce":"25","read":false,"x":90,"y":140,"wires":[["1c47f381.bb5aac"]]},{"id":"898a8091.321198","type":"ui_template","z":"cead70f3.3f516","group":"e11671b0.15d4","name":"","order":1,"width":"","height":"","format":"<iframe width=\"854\" height=\"480\" src=\"https://webcamsydney.com/\" frameborder=\"0\" allowfullscreen></iframe>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":960,"y":460,"wires":[[]]},{"id":"dd7b3ae5.824a88","type":"ui_template","z":"cead70f3.3f516","group":"fbb208d4.1f9628","name":"","order":1,"width":"0","height":"0","format":"<iframe id=\"camframe\" src=\"http://dmzweb.cityofadelaide.com.au/webcam/images/bellnth.jpg?0.08860109259700422/public/default_iframe_n.asp?wmode=transparent\" scrolling=\"no\" allowfullscreen=\"\" wmode=\"transparent\" onload=\"resetHeight('camframe')\" style=\"height: 200px;\" width=\"100%\" height=\"850px\" frameborder=\"0\" align=\"middle\"></iframe>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":960,"y":500,"wires":[[]]},{"id":"faaa49f6.48b668","type":"function","z":"cead70f3.3f516","name":"audio extraction","func":"var newmsg;\nif (msg.payload == 'Open')\n    msg.payload = 'front gate opening';   \nif (msg.payload == 'Close')\n    msg.payload = 'front gate closing';\nif (msg.payload == 'Please Enter Password')\n    msg.payload = 'Please Enter Password';\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":100,"wires":[["582f941c.3fecdc"]]},{"id":"582f941c.3fecdc","type":"play audio","z":"cead70f3.3f516","name":"","voice":"3","x":980,"y":260,"wires":[]},{"id":"fcb7f33.c9a111","type":"ui_form","z":"cead70f3.3f516","name":"System Password","label":"Enable System Password","group":"ee47ef20.214d48","order":0,"width":0,"height":0,"options":[{"label":"Enter","value":"Password","type":"text","required":true}],"formValue":{"Password":""},"payload":"","topic":"","x":110,"y":500,"wires":[["60f83c68.625cc4"]]},{"id":"60f83c68.625cc4","type":"function","z":"cead70f3.3f516","name":"Password Checker","func":"var password = msg.payload.Password;\nif (password == \"0400589979\")\n    {\n    global.set(\"sys_enable\", 1);\n    msg.payload = \"password matched\";\n    msg.topic = \"match\";\n    }\nelse\n    {\n    global.set(\"sys_enable\", 0);\n    msg.topic = \"no match\"\n    msg.payload = \"incorrect password     try again\";\n    }\n//msg.payload = password;\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":500,"wires":[["fc4ffecc.f136f","582f941c.3fecdc"]]},{"id":"7fda6251.c2bc3c","type":"change","z":"cead70f3.3f516","name":"Gate Closed","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Closed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":140,"wires":[["582f941c.3fecdc"]]},{"id":"360eaffe.d5bd4","type":"change","z":"cead70f3.3f516","name":"Gate Open","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Open","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":180,"wires":[["582f941c.3fecdc"]]},{"id":"1c47f381.bb5aac","type":"switch","z":"cead70f3.3f516","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":290,"y":140,"wires":[["7fda6251.c2bc3c"],["360eaffe.d5bd4"]]},{"id":"b8789bde.cac458","type":"ui_button","z":"cead70f3.3f516","name":"Gate Close","group":"a3f313e.1af68f","order":0,"width":"2","height":"1","passthru":true,"label":"Close","color":"White","bgcolor":"Green","icon":"SGateClosed 1","payload":"Close","payloadType":"str","topic":"","x":310,"y":80,"wires":[["46640a3e.5ee4a4","8c5452b8.3a682"]]},{"id":"35c12a63.99a516","type":"inject","z":"cead70f3.3f516","name":"Gate Close","topic":"","payload":"Close","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":80,"wires":[["b8789bde.cac458"]]},{"id":"fc4ffecc.f136f","type":"debug","z":"cead70f3.3f516","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":530,"y":500,"wires":[]},{"id":"f0695def.ba6f9","type":"function","z":"cead70f3.3f516","name":"Open Enable","func":"msg.payload = global.get(\"sys_enable\");\nif (msg.payload == 1)\n    node.send({payload:\"Open\"});\nelse \n    if (msg.payload == 0)\n        node.send({payload:\"Please Enter Password\"});\n    \n//return msg;","outputs":1,"noerr":0,"x":530,"y":20,"wires":[["7d024680.5bc2c8","faaa49f6.48b668","8ca49b65.4e3fe8"]]},{"id":"46640a3e.5ee4a4","type":"function","z":"cead70f3.3f516","name":"Close Enable","func":"msg.payload = global.get(\"sys_enable\");\nif (msg.payload == 1)\n    node.send({payload:\"Close\"});\nelse \n    if (msg.payload == 0)\n        node.send({payload:\"Please Enter Password\"});\n    \n//return msg;","outputs":1,"noerr":0,"x":530,"y":100,"wires":[["7d024680.5bc2c8","faaa49f6.48b668","8ca49b65.4e3fe8"]]},{"id":"f60cb335.aa29e","type":"function","z":"cead70f3.3f516","name":"Send Enter Password","func":"msg.payload = global.get(\"sys_enable\");\nif (msg.payload == 0)\n    node.send({payload:\"Please enter correct password\"});\n//return msg;","outputs":1,"noerr":0,"x":1000,"y":340,"wires":[[]]},{"id":"a3f6852a.f0b118","type":"rpi-gpio in","z":"cead70f3.3f516","name":"Call","pin":"29","intype":"up","debounce":"25","read":false,"x":70,"y":340,"wires":[["c3aecb07.1c4968","b3d0b9c8.077168"]]},{"id":"cc152f8f.992dc","type":"rpi-gpio in","z":"cead70f3.3f516","name":"Gate Open","pin":"31","intype":"down","debounce":"25","read":false,"x":80,"y":260,"wires":[["90b3a4d3.2f6028"]]},{"id":"84abd1f1.06c6b","type":"rpi-gpio in","z":"cead70f3.3f516","name":"Gate Closed","pin":"33","intype":"down","debounce":"25","read":false,"x":90,"y":200,"wires":[["5d05bf12.c22e2"]]},{"id":"3a3f49dc.68bef6","type":"change","z":"cead70f3.3f516","name":"Call Button Pressed","rules":[{"t":"set","p":"payload","pt":"msg","to":"Call Button Pressed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1000,"y":380,"wires":[[]]},{"id":"c3aecb07.1c4968","type":"function","z":"cead70f3.3f516","name":"audio extraction","func":"if (msg.payload == 1) \n    {\n     node.send({payload:\"Someone is at the front gate\"});\n    }\n//return msg;","outputs":1,"noerr":0,"x":460,"y":340,"wires":[["582f941c.3fecdc"]]},{"id":"b3d0b9c8.077168","type":"link out","z":"cead70f3.3f516","name":"Call Button Pressed","links":["d8387656.2e3f98"],"x":355,"y":300,"wires":[]},{"id":"a77d6702.5a6b28","type":"ui_slider","z":"cead70f3.3f516","name":"","label":"Gate","group":"ed497587.c8d9b","order":0,"width":0,"height":0,"passthru":false,"topic":"","min":0,"max":10,"step":1,"x":610,"y":260,"wires":[[]],"icon":"node-red-dashboard/ui_switch.png"},{"id":"5d05bf12.c22e2","type":"function","z":"cead70f3.3f516","name":"Gate Closed","func":"if (msg.payload == 1)\n    {\n    msg.payload = 10;\n    msg.topic = \"Gate Closed\";\n    return msg;\n    //node.send({payload:msg});\n    }\nif (msg.payload == 0)\n    {\n    msg.payload = 5\n    msg.topic = \"Gate Open\";\n    return msg;\n    //node.send({payload:msg});\n    }\n//return msg;","outputs":1,"noerr":0,"x":390,"y":200,"wires":[["a77d6702.5a6b28","eade90ac.33241","5d01d1dc.a0f6f"]]},{"id":"90b3a4d3.2f6028","type":"function","z":"cead70f3.3f516","name":"Gate Open","func":"if (msg.payload == 1)\n    {\n    msg.payload = 0;\n    msg.topic = \"Gate Open\";\n    return msg;\n    //node.send({payload:msg});\n    }\nif (msg.payload == 0)\n    {\n    msg.payload = 5;\n    msg.topic = \"Gate Open\";\n    return msg;\n    //node.send({payload:msg});\n    }\n//return msg;","outputs":1,"noerr":0,"x":390,"y":260,"wires":[["a77d6702.5a6b28","eade90ac.33241","56ee393.614c3c8"]]},{"id":"eade90ac.33241","type":"debug","z":"cead70f3.3f516","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":610,"y":220,"wires":[]},{"id":"8c5452b8.3a682","type":"debug","z":"cead70f3.3f516","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":530,"y":60,"wires":[]},{"id":"8ca49b65.4e3fe8","type":"debug","z":"cead70f3.3f516","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":20,"wires":[]},{"id":"9924fba4.12b358","type":"inject","z":"cead70f3.3f516","name":"Call Test","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":400,"wires":[["59620a21.5586d4"]]},{"id":"59620a21.5586d4","type":"ui_button","z":"cead70f3.3f516","name":"Call Test","group":"ed497587.c8d9b","order":0,"width":0,"height":0,"passthru":true,"label":"Call Test","color":"","bgcolor":"","icon":"","payload":"1","payloadType":"num","topic":"","x":240,"y":400,"wires":[["c3aecb07.1c4968","b3d0b9c8.077168"]]},{"id":"23c05e55.79c682","type":"e-mail","z":"cead70f3.3f516","server":"smtp.gmail.com","port":"465","secure":true,"name":"cs_hayes@hotmail.com","dname":"Send Email","x":750,"y":340,"wires":[]},{"id":"8e0dce91.924a4","type":"function","z":"cead70f3.3f516","name":"","func":"var msg.filename = '/home/pi/Pictures/grabCAM1a.jpg';\n\nreturn msg;","outputs":1,"noerr":4,"x":500,"y":400,"wires":[[]]},{"id":"5d01d1dc.a0f6f","type":"switch","z":"cead70f3.3f516","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"5","vt":"str"},{"t":"eq","v":"10","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":630,"y":400,"wires":[[],["6633c503.0a6acc"],["a9c1fcb9.0e25"]]},{"id":"a9c1fcb9.0e25","type":"change","z":"cead70f3.3f516","name":"Gate Closed","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Closed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":460,"wires":[["582f941c.3fecdc"]]},{"id":"6633c503.0a6acc","type":"change","z":"cead70f3.3f516","name":"Gate Closing","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Opening","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":420,"wires":[["582f941c.3fecdc"]]},{"id":"56ee393.614c3c8","type":"switch","z":"cead70f3.3f516","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"5","vt":"str"},{"t":"eq","v":"10","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":610,"y":540,"wires":[["b798f502.e39ca8"],["993226ad.6d1d98"],[]]},{"id":"b798f502.e39ca8","type":"change","z":"cead70f3.3f516","name":"Gate Open","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Open","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":520,"wires":[["582f941c.3fecdc"]]},{"id":"993226ad.6d1d98","type":"change","z":"cead70f3.3f516","name":"Gate Opening","rules":[{"t":"set","p":"payload","pt":"msg","to":"Front Gate Closeing","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":560,"wires":[["582f941c.3fecdc"]]},{"id":"a3f313e.1af68f","type":"ui_group","z":"","name":"Gate Control","tab":"a2bf996c.3e4038","order":3,"disp":true,"width":"4","collapse":false},{"id":"be12b1fc.f2ab","type":"ui_group","z":"","name":"Colour Buttons","tab":"a6ae4466.984d88","disp":true,"width":"6"},{"id":"e11671b0.15d4","type":"ui_group","z":"","name":"Web Cameras","tab":"3b803689.71d6ca","disp":true,"width":"16","collapse":false},{"id":"fbb208d4.1f9628","type":"ui_group","z":"","name":"Colour Buttons","tab":"11213176.b6081f","disp":true,"width":"6"},{"id":"ee47ef20.214d48","type":"ui_group","z":"","name":"Security","tab":"7105acb0.29e7b4","order":1,"disp":true,"width":"9","collapse":false},{"id":"ed497587.c8d9b","type":"ui_group","z":"","name":"Gate Position","tab":"a2bf996c.3e4038","order":2,"disp":true,"width":"6","collapse":false},{"id":"a2bf996c.3e4038","type":"ui_tab","z":"","name":"Front Gate Controller","icon":"dashboard","order":1},{"id":"a6ae4466.984d88","type":"ui_tab","z":"","name":"testing","icon":"dashboard","order":3},{"id":"3b803689.71d6ca","type":"ui_tab","z":"","name":"Nerf Gun","icon":"dashboard","order":2},{"id":"11213176.b6081f","type":"ui_tab","z":"","name":"testing","icon":"dashboard","order":4},{"id":"7105acb0.29e7b4","type":"ui_tab","z":"","name":"System Enable","icon":"dashboard"}]