[{"id":"59926ceb.5c4984","type":"inject","z":"c01fb5a7.feeee8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":151.625,"y":59,"wires":[["8adb4de9.7a681"]]},{"id":"8adb4de9.7a681","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"true","complete":"payload","x":386.62506103515625,"y":57.25,"wires":[]},{"id":"1d3f0f6d.54b8f1","type":"inject","z":"c01fb5a7.feeee8","name":"Hello Siri","topic":"","payload":"Hello Siri","payloadType":"str","repeat":"","crontab":"","once":false,"x":135,"y":244.25006103515625,"wires":[[]]},{"id":"6df69bb4.744004","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":525.5000495910645,"y":101.66666221618652,"wires":[]},{"id":"b23e54df.22fca8","type":"function","z":"c01fb5a7.feeee8","name":"","func":"msg.payload = msg.payload.toString();\nreturn msg;","outputs":1,"noerr":0,"x":338.0000114440918,"y":103.75002765655518,"wires":[["6df69bb4.744004"]]},{"id":"d262c4ee.886fd8","type":"function","z":"c01fb5a7.feeee8","name":"Relay Words Spoken","func":"var msg = msg.payload;\nvar relayone = '0';\nvar relaytwo = '0';\nvar relaythree = '0';\nif (msg == \"relay one on\")\n    {\n    relayone = '1';\n    }\nif (msg == \"relay one off\")\n    {\n    relayone = '0';\n    }\nif (msg == \"relay two on\")\n    {\n    relaytwo = '1';\n    }\nif (msg == \"relay two off\")\n    {\n    relaytwo = '0';\n    }    \nif (msg == \"relay three on\")\n    {\n    relaythree = '1';\n    }\nif (msg == \"relay three off\")\n    {\n    relaythree = '0';\n    }   \nreturn [relayone,relaytwo,relaythree];\n","outputs":"3","noerr":0,"x":711.0416412353516,"y":217,"wires":[["49eb1077.ec55e","e27149c9.a70d98"],["765d2275.d23a5c","9192b254.9ab65"],["5bcd819d.aaaaf","e58ad650.08f678"]]},{"id":"d62c548b.48e7c8","type":"rpi-gpio out","z":"c01fb5a7.feeee8","name":"Relay1","pin":"11","set":true,"level":"1","out":"out","x":1194.0416259765625,"y":168,"wires":[]},{"id":"223cdd78.4a7212","type":"rpi-gpio out","z":"c01fb5a7.feeee8","name":"Relay2","pin":"13","set":true,"level":"1","out":"out","x":1192.0416259765625,"y":220,"wires":[]},{"id":"c0ac3ba7.23e268","type":"rpi-gpio out","z":"c01fb5a7.feeee8","name":"Relay3","pin":"15","set":true,"level":"1","out":"out","x":1193.0416259765625,"y":278,"wires":[]},{"id":"385fa026.8e862","type":"function","z":"c01fb5a7.feeee8","name":"Other Words Spoken","func":"newMsg = msg.payload;\nvar str = newMsg;\nvar foxtel_spoken = str.search(\"foxtel\");\nvar dvd_spoken = str.search(\"dvd\");\nvar media_player_spoken = str.search(\"media player\");\nvar cd_spoken = str.search(\"cd\");\nvar media_source = \"\";\n\n//test if input selections spoken\nif (foxtel_spoken < 0)\n    {\n    media_source = \"Foxtel\";\n    }\nif (dvd_spoken < 0)\n    {\n    media_source = \"DVD\";\n    }\nif (media_player_spoken < 0)\n    {\n    media_source = \"Media Player\";\n    }\nif (cd_spoken < 0)\n    {\n    media_source = \"CD\";\n    }\n\nreturn media_source;","outputs":"1","noerr":0,"x":712.0416412353516,"y":153,"wires":[["95acd09d.13613"]]},{"id":"7b56dd4e.9584d4","type":"function","z":"c01fb5a7.feeee8","name":"Test if Computer Spoken","func":"msg.payload = msg.payload.toString();\nnewMsg = msg.payload;\nvar str = newMsg;\n\nvar computer_spoken = str.search(\"computer\");\n\n//test if computer spoken\nif (computer_spoken < 0)\n    {\n    return str; \n    }\nreturn null;","outputs":"1","noerr":0,"x":384.04164123535156,"y":153,"wires":[["d262c4ee.886fd8","385fa026.8e862"]]},{"id":"95acd09d.13613","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1007.0416793823242,"y":143.00000190734863,"wires":[]},{"id":"79e246cd.3fb168","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 1 on","topic":"","payload":"relay one on","payloadType":"str","repeat":"","crontab":"","once":false,"x":172,"y":361,"wires":[["4fbd3127.e8df9","44688f2.db1a17","9426afa.d1fb45","2e0fb518.a5997a"]]},{"id":"59e09c3.e48fd64","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 1 off","topic":"","payload":"relay one off","payloadType":"str","repeat":"","crontab":"","once":false,"x":173,"y":402,"wires":[["4fbd3127.e8df9","44688f2.db1a17","9426afa.d1fb45","2e0fb518.a5997a"]]},{"id":"aeeb95b3.584cf8","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 2 on","topic":"","payload":"relay two on","payloadType":"str","repeat":"","crontab":"","once":false,"x":174,"y":445,"wires":[["4fbd3127.e8df9","44688f2.db1a17","d262c4ee.886fd8"]]},{"id":"843879dc.cce118","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 2 off","topic":"","payload":"relay two off","payloadType":"str","repeat":"","crontab":"","once":false,"x":175,"y":484,"wires":[["4fbd3127.e8df9","44688f2.db1a17","d262c4ee.886fd8"]]},{"id":"7615bac1.b430c4","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 3 on","topic":"","payload":"relay three on","payloadType":"str","repeat":"","crontab":"","once":false,"x":177,"y":526,"wires":[["4fbd3127.e8df9","44688f2.db1a17","d262c4ee.886fd8"]]},{"id":"c3fd7224.a1e34","type":"inject","z":"c01fb5a7.feeee8","name":"Relay 3 off","topic":"","payload":"relay three off","payloadType":"str","repeat":"","crontab":"","once":false,"x":178,"y":565,"wires":[["4fbd3127.e8df9","44688f2.db1a17","d262c4ee.886fd8"]]},{"id":"49eb1077.ec55e","type":"function","z":"c01fb5a7.feeee8","name":"Toggle Relay 1 On/Off","func":"context.state = context.state || '0';\n\n(context.state == '0') ? context.state == '1' : context.state == '0';\nmsg.payload = context.state;\n\nreturn msg;","outputs":"1","noerr":0,"x":966,"y":188,"wires":[["d62c548b.48e7c8"]]},{"id":"765d2275.d23a5c","type":"function","z":"c01fb5a7.feeee8","name":"Toggle Relay 2 On/Off","func":"context.state = context.state || 0;\n\n(context.state == 0) ? context.state == 1 : context.state == 0;\nmsg.payload = context.state;\n\nreturn msg;","outputs":"1","noerr":0,"x":964,"y":223,"wires":[["223cdd78.4a7212"]]},{"id":"5bcd819d.aaaaf","type":"function","z":"c01fb5a7.feeee8","name":"Toggle Relay 3 On/Off","func":"context.state = context.state || 0;\n\n(context.state == 0) ? context.state == 1 : context.state == 0;\nmsg.payload = context.state;\n\nreturn msg;","outputs":"1","noerr":0,"x":962,"y":259,"wires":[["c0ac3ba7.23e268"]]},{"id":"387dfccf.2ca814","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1087,"y":393,"wires":[]},{"id":"4fbd3127.e8df9","type":"function","z":"c01fb5a7.feeee8","name":"Relay Words Spoken","func":"msg = msg.payload.toString();\nvar str = msg;\nvar newMsg;\nvar relay_mode;\nvar relay_one_on = str.search(\"relay one on\");\nvar relay_one_off = str.search(\"relay one off\");\nvar relay_two_on = str.search(\"relay two on\");\nvar relay_two_off = str.search(\"relay two off\");\nvar relay_three_on = str.search(\"relay three on\");\nvar relay_three_off = str.search(\"relay three off\");\n\nif (msg === 'relay one on');\n    {\n    newMsg = '1';    \n    }\nif (msg === 'relay one off')\n    {\n    newMsg = '0';        \n    }\nif (msg === 'relay two on');\n    {\n    newMsg = 1;\n    }\nif (msg === 'relay two off');\n    {\n    newMsg = 0;        \n    }\nif (msg === \"relay three on\");\n    {\n    newMsg = 1;\n    }\nif (msg === \"relay three off\");\n    {\n    newMsg = 0;        \n    }\n\n//node.send({payload:relay_mode});\n\nreturn [newMsg];","outputs":"1","noerr":0,"x":679,"y":408,"wires":[["8ed79d1f.3d18c","c0fbc81.769c138"]]},{"id":"8ed79d1f.3d18c","type":"json","z":"c01fb5a7.feeee8","name":"","x":883,"y":393,"wires":[["387dfccf.2ca814"]]},{"id":"c0fbc81.769c138","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1016,"y":474,"wires":[]},{"id":"44688f2.db1a17","type":"function","z":"c01fb5a7.feeee8","name":"","func":"var msg = msg.payload;\nvar relayone = '0';\nvar relaytwo = '0';\nvar relaythree = '0';\nif (msg == \"relay one on\")\n    {\n    relayone = '1';\n    }\nif (msg == \"relay one off\")\n    {\n    relayone = '0';\n    }\nif (msg == \"relay two on\")\n    {\n    relaytwo = '1';\n    }\nif (msg == \"relay two off\")\n    {\n    relaytwo = '0';\n    }    \nif (msg == \"relay three on\")\n    {\n    relaythree = '1';\n    }\nif (msg == \"relay three off\")\n    {\n    relaythree = '0';\n    }   \n//node.send ({payload:[relaym.payload]});    \nreturn [relayone,relaytwo,relaythree];","outputs":"3","noerr":0,"x":695,"y":504,"wires":[["34ade985.5728e6"],["35e663c6.0234fc"],["c4263af2.3aaca8"]]},{"id":"34ade985.5728e6","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"true","x":855.0000114440918,"y":486.00000762939453,"wires":[]},{"id":"eae325d7.3f0de8","type":"function","z":"c01fb5a7.feeee8","name":"Relay Words Spoken","func":"var msg = msg.payload;\nvar relaym = 0;\nif (msg == \"relay one on\")\n    {\n    relaym = '1';\n    }\nif (msg == \"relay one off\")\n    {\n    relaym = '0';\n    }\nif (msg == \"relay two on\")\n    {\n    relaym = '1';\n    }\nif (msg == \"relay two off\")\n    {\n    relaym = '0';\n    }    \nif (msg == \"relay three on\")\n    {\n    relaym = '1';\n    }\nif (msg == \"relay three off\")\n    {\n    relaym = '0';\n    }   \n//node.send ({payload:[relaym.payload]});    \nreturn [relaym];\n\n\n//newMsg = msg.payload;\n//var str = newMsg;\n//var relay_one_on = str.search(\"relay one on\");\n//var relay_one_on = str.indexOf(\"relay one on\") !== -1;\n//var relay_one_off = str.indexOf(\"relay one off\") !== -1;\n//var relay_two_on = str.indexOf(\"relay two on\") !== -1;\n//var relay_two_off = str.indexOf(\"relay two off\") !== -1;\nvar relay_three_on = str.indexOf(\"relay three on\") !== -1;\nvar relay_three_off = str.indexOf(\"relay three off\") !== -1;\nvar on = 0;\nvar off = 1;\n\nif (relay_one_on < true)\n    {\n    return[on,null,null];\n    }\nif (relay_one_off < true)\n    {\n    return[off,null,null];\n    }\nif (relay_two_on < true)\n    {\n    return[null,on,null];\n    }\nif (relay_two_off < true)\n    {\n    return[null,off,null];\n    }\nif (relay_three_on < true)\n    {\n    return[null,null,on];\n    }\nif (relay_three_off < true)\n    {\n    return[null,null,off];\n    }\n\nreturn null;","outputs":"3","noerr":0,"x":671.0000076293945,"y":363.0000057220459,"wires":[[],[],[]]},{"id":"e27149c9.a70d98","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1017.1666831970215,"y":20,"wires":[]},{"id":"9192b254.9ab65","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1006.1666259765625,"y":58.111114501953125,"wires":[]},{"id":"e58ad650.08f678","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":1011.1666259765625,"y":107.11111450195312,"wires":[]},{"id":"35e663c6.0234fc","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":928.1666259765625,"y":538.1111450195312,"wires":[]},{"id":"c4263af2.3aaca8","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":989.1666259765625,"y":597.1111450195312,"wires":[]},{"id":"9426afa.d1fb45","type":"trigger","z":"c01fb5a7.feeee8","op1":"","op2":"0","op1type":"pay","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"","name":"Relay 1","x":677.1666793823242,"y":588.4444532394409,"wires":[[]]},{"id":"76c32b54.d6eb14","type":"debug","z":"c01fb5a7.feeee8","name":"","active":false,"console":"false","complete":"false","x":869.1666870117188,"y":642.1111450195312,"wires":[]},{"id":"2e0fb518.a5997a","type":"function","z":"c01fb5a7.feeee8","name":"Relay one","func":"if (msg.payload.data == 'relay one on')\n    {\n    msg.payload = 1;\n    return msg;\n    }\nelse\n    {\n    msg.payload = 0;\n    return msg;\n    }\nreturn null;","outputs":1,"noerr":0,"x":554.1666259765625,"y":710.8889064788818,"wires":[["76c32b54.d6eb14"]]},{"id":"5151ddcd.6c4e94","type":"function","z":"c01fb5a7.feeee8","name":"Split Data","func":"// seperate string in arrays and find how many elements in array\nvar msgdata = msg.payload.split(\" \");\nvar datalength = msgdata.length;\n\nfor (i = 0; i < msgdata.length; i++) // llok for word relay\n    { \n    if (msgdata[i] == \"relay\")\n        {\n        var relay_index = i;\n        //node.send ({payload:[msgdata[relay_index]]});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word one\n    { \n    if (msgdata[i] == \"one\")\n        {\n        var one_index = i;\n        var relay_number = 1;\n        //node.send ({payload:[msgdata[one_index]]});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word two\n    { \n    if (msgdata[i] == \"two\")\n        {\n        var two_index = i;\n        var relay_number = 2;\n        //node.send ({payload:[msgdata[two_index]]});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word three\n    { \n    if (msgdata[i] == \"three\")\n        {\n        var three_index = i;\n        var relay_number = 3;\n        //node.send ({payload:[msgdata[three_index]]});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word on\n    { \n    if (msgdata[i] == \"on\")\n        {\n        var on_index = i;\n        var relay_mode = 'on';\n        //var d_msg = (\"relay \" + relay_number + \" on\");\n        //return [\"relay \" + relay_number + \" on\"];\n        //node.send ({payload:[msgdata[on_index]]});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word off\n    { \n    if (msgdata[i] == \"off\")\n        {\n        var off_index = i;\n        var relay_mode = 'off';\n        //var d_msg = (\"relay \" + relay_number + \" off\");\n        //return [\"relay \" + relay_number + \" off\"];\n        //node.send ({payload:[msgdata[off_index]]});\n        }\n    }\n\n//send to output on off signals to the three ports    \nif (relay_number == 1)\n    {\n    //var d_msg = (\"relay \" + relay_number + \" off\");\n    //return [\"relay \" + relay_number + \" off\"];\n    node.send ({payload:[\"relay 1 \" + relay_mode]});\n    \n    //node.send ({payload:[\"relay \" + relay_number + \" on/off\"]});\n    //return ['out 1',null,null];\n    }\nif (relay_number == 2)\n    {\n    node.send ({payload:[\"relay 2 \" + relay_mode]});        \n    //node.send ({payload:[null,\"relay 2 \" + relay_mode,null]});        \n    \n    //return [null,'out 2',null];\n    }\nif (relay_number == 3)\n    {\n    node.send ({payload:[\"relay 3 \" + relay_mode]});    \n    //node.send ({payload:[null,null,\"relay 3 \" + relay_mode]});    \n    //node.send ({payload:[\"relay \" + relay_number + \" on/off\"]});\n    //return [null,null,'out 3'];\n    }\n\n//node.send ({payload:[datalength]});\n\nreturn [null];\n\n\n\n\n//working code\n//var msgdata = msg.payload.split(\" \");\n//var datalength = msgdata.length;\n//node.send ({payload:[msgdata[0]]});\n//node.send ({payload:[msgdata[1]]});\n//node.send ({payload:[msgdata[2]]});\n//node.send ({payload:[datalength]});\n//return [null];\n","outputs":"1","noerr":0,"x":695,"y":276,"wires":[[]]}]