[{"id":"a0cf29db.2ca328","type":"link in","z":"b67df324.45e33","name":"Relay Data From Siri","links":["3a083f00.0e1a52","f5b0f59a.32a7f8"],"x":161.6666555404663,"y":59.388885498046875,"wires":[["1c4f4b9e.f7b204","cd215559.a83fa8"]]},{"id":"cd215559.a83fa8","type":"function","z":"b67df324.45e33","name":"Split Data - Garage Door","func":"// seperate string in arrays and find how many elements in array\nvar msgdata = msg.payload.split(\" \");\nvar datalength = msgdata.length;\nvar door_mode = 'open';\n\nfor (i = 0; i < msgdata.length; i++) // look for the word one\n    { \n    if (msgdata[i] == \"front\")\n        {\n        var garage_door_index = i;\n        var door_number = 1;\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word one\n    { \n    if (msgdata[i] == \"rear\")\n        {\n        var shed_door_index = i;\n        var door_number = 2;\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word one\n    { \n    if (msgdata[i] == \"shed\")\n        {\n        var shed_door_index = i;\n        var door_number = 2;\n        }\n    }\n    \nfor (i = 0; i < msgdata.length; i++) // look for the word open\n    { \n    if (msgdata[i] == \"open\")\n        {\n        var door_mode_index = i;\n        door_mode = 'open';\n        }\n    }\n\nfor (i = 0; i < msgdata.length; i++) // look for the word close\n    { \n    if (msgdata[i] == \"close\")\n        {\n        var door_mode_index = i;\n        door_mode = 'close';\n        }\n    }\n\n//send to output on off signals to the relay    \nif (door_number == 1) //front garage door\n    {\n    node.send ({payload:[\"front garage door \" + door_mode]});\n    }\nif (door_number == 2) //shed or rear roller door\n    {\n    node.send ({payload:[\"rear garage door \" + door_mode]});\n    }\n    \nreturn [null];","outputs":"1","noerr":0,"x":426.50000762939453,"y":76.6746244430542,"wires":[["c7289813.4815b8","dd181e82.60601","d68380d8.14c45"]]},{"id":"6c7645f4.555bec","type":"function","z":"b67df324.45e33","name":"System Said","func":"var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n\nif (newWord == \"front garage door open\")\n    {\n    newMsg = \"front garage door opening\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"front garage door close\")\n    {\n    newMsg = \"front garage door closing\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"rear garage door open\")\n    {\n    newMsg = \"rear garage door opening\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"rear garage door close\")\n    {\n    newMsg = \"rear garage door closing\";\n    node.send ({payload:newMsg});\n    }\nreturn null;\n","outputs":1,"noerr":0,"x":889.3333511352539,"y":206.333327293396,"wires":[["20230df9.d33662"]]},{"id":"e8c18b4.94f4a78","type":"inject","z":"b67df324.45e33","name":"Side Gate Open","topic":"","payload":"Side_Gate_Open","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":160.14286586216517,"y":202.57143293108257,"wires":[["ce0f385b.f4fe78"]]},{"id":"d68380d8.14c45","type":"function","z":"b67df324.45e33","name":"Siri Said","func":"var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n//newMsg = \"Siri said\";\n//node.send ({payload:newMsg});\nsleep (500);\n\nif (newWord == \"front garage door open\")\n    {\n    newMsg = \"front garage door open\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"front garage door close\")\n    {\n    newMsg = \"front garage door close\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"rear garage door open\")\n    {\n    newMsg = \"rear garage door open\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"rear garage door close\")\n    {\n    newMsg = \"rear garage door close\";\n    node.send ({payload:newMsg});\n    }\nreturn null;\n","outputs":1,"noerr":0,"x":826,"y":130,"wires":[["e1da20e0.177ab","20230df9.d33662"]]},{"id":"f81ef50f.789d68","type":"ui_button","z":"b67df324.45e33","name":"Rear Door Close","group":"69155b39.e9e154","order":4,"width":"3","height":"1","passthru":true,"label":"Rear Door Close","color":"","bgcolor":"Blue","icon":"","payload":"rear garage door close","payloadType":"str","topic":"","x":370.57147434779574,"y":353.1428662708828,"wires":[["acc8e1db.aead4"]]},{"id":"dd181e82.60601","type":"debug","z":"b67df324.45e33","name":"","active":false,"console":"false","complete":"false","x":820.8691635131836,"y":32.92460632324219,"wires":[]},{"id":"e1da20e0.177ab","type":"debug","z":"b67df324.45e33","name":"","active":false,"console":"false","complete":"false","x":1073,"y":63,"wires":[]},{"id":"6e55552a.3db87c","type":"ui_button","z":"b67df324.45e33","name":"Rear Door Open","group":"69155b39.e9e154","order":2,"width":"3","height":"1","passthru":true,"label":"Rear Door Open","color":"","bgcolor":"Blue","icon":"","payload":"rear garage door open","payloadType":"str","topic":"","x":370.85715321132113,"y":303.42860044751853,"wires":[["acc8e1db.aead4"]]},{"id":"32b14c27.c41344","type":"inject","z":"b67df324.45e33","name":"Side Gate Close","topic":"","payload":"Side_Gate_Close","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":161.42857360839844,"y":252.85714721679688,"wires":[["edce153a.da54e8"]]},{"id":"20230df9.d33662","type":"link out","z":"b67df324.45e33","name":"From Garage Doors","links":["5218ba8d.aa04a4"],"x":1071,"y":160,"wires":[]},{"id":"ce0f385b.f4fe78","type":"ui_button","z":"b67df324.45e33","name":"Side Gate Open","group":"69155b39.e9e154","order":1,"width":"3","height":"1","passthru":true,"label":"Side Gate Open","color":"","bgcolor":"","icon":"","payload":"Side_Gate_Open","payloadType":"str","topic":"","x":361.41272735595703,"y":203.14288234710693,"wires":[["acc8e1db.aead4"]]},{"id":"acc8e1db.aead4","type":"function","z":"b67df324.45e33","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":633.0000267028809,"y":277.71430921554565,"wires":[["50d8eb68.058f14","c7289813.4815b8","6c7645f4.555bec"]]},{"id":"c7289813.4815b8","type":"link out","z":"b67df324.45e33","name":"Garage Door","links":["95cce6d5.27ac38"],"x":765.5477962493896,"y":76.23809242248535,"wires":[]},{"id":"1c4f4b9e.f7b204","type":"debug","z":"b67df324.45e33","name":"","active":false,"console":"false","complete":"false","x":387.0654716491699,"y":120.47620582580566,"wires":[]},{"id":"50d8eb68.058f14","type":"debug","z":"b67df324.45e33","name":"","active":false,"console":"false","complete":"false","x":823.571533203125,"y":319.1428527832031,"wires":[]},{"id":"fdc24081.7c98d","type":"inject","z":"b67df324.45e33","name":"Rear Door Open","topic":"","payload":"rear garage door open","payloadType":"str","repeat":"","crontab":"","once":false,"x":157.14285278320312,"y":302.8571472167969,"wires":[["6e55552a.3db87c"]]},{"id":"edce153a.da54e8","type":"ui_button","z":"b67df324.45e33","name":"Side Gate Close","group":"69155b39.e9e154","order":3,"width":"3","height":"1","passthru":true,"label":"Side Gate Close","color":"","bgcolor":"","icon":"","payload":"Side_Gate_Close","payloadType":"str","topic":"","x":362.5714874267578,"y":252.85715198516846,"wires":[["acc8e1db.aead4"]]},{"id":"e1ba5c41.63ce2","type":"function","z":"b67df324.45e33","name":"Siri Said","func":"//var myDelay = setInterval(myTimer, 1000);\n\nvar newWord = msg.payload;\n//var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n\n//newMsg = \"Siri said\";\n//node.send ({payload:newMsg});\n//sleep(500);\n\nnewMsg = newWord;\nnode.send ({payload:newMsg});\n\n//sleep(500);\n\n//newMsg =\"Degrees\";\n//node.send ({payload:newMsg});\n\n\n//msg.payload = msg.payload.toString();\n//msg = \"Current Temperature is\";\n//+msg+\"Degrees\"';\n//msg = 'Current Temperature is\"'+msg+'Degrees\"'\n//newMsg = 'select * from weather.forecast where woeid in (select woeid from geo.places(1) where text=\"'+msg+',au\") and u=\"c\"';\n\n//msg = \"Relay Three Off\";\n//node.send ({payload:newMsg});\nreturn null;","outputs":1,"noerr":0,"x":929.7778930664062,"y":463.66666412353516,"wires":[[]]},{"id":"f98b3d0b.383f5","type":"inject","z":"b67df324.45e33","name":"Rear Door Close","topic":"","payload":"rear garage door close","payloadType":"str","repeat":"","crontab":"","once":false,"x":158.4285605294364,"y":353.1428615025112,"wires":[["f81ef50f.789d68"]]},{"id":"69155b39.e9e154","type":"ui_group","z":"","name":"Control","tab":"626c43d5.91a98c","disp":true,"width":"6"},{"id":"626c43d5.91a98c","type":"ui_tab","z":"","name":"Garage Door","icon":"dashboard","order":12}]