[{"id":"223d409d.1217d","type":"ui_button","z":"9ee7463e.23def8","name":"Sub Woofer On","group":"1f02a526.1ce6cb","order":0,"width":"3","height":"1","passthru":true,"label":"Sub Woofer On","color":"Black","bgcolor":"Yellow","icon":"","payload":"sub woofer on","payloadType":"str","topic":"","x":579,"y":55,"wires":[["ad6eb457.7bc928","d59d44c9.358a88"]]},{"id":"b91e72eb.efd7a","type":"ui_button","z":"9ee7463e.23def8","name":"Sub Woofer Off","group":"1f02a526.1ce6cb","order":0,"width":"3","height":"1","passthru":true,"label":"Sub Woofer Off","color":"Black","bgcolor":"Yellow","icon":"","payload":"sub woofer off","payloadType":"str","topic":"","x":582,"y":141,"wires":[["ad6eb457.7bc928","5fa46e03.1828e"]]},{"id":"d7d3a21b.0d6d8","type":"function","z":"9ee7463e.23def8","name":"Siri Said","func":"var msgdata = msg.payload.split(\" \");\nvar newMsg = {};\nnewMsg.topic = \"Sub Woofer Controls\";\nvar datalength = msgdata.length;\nvar subwoofer_found = 0;\n//var door_mode = 'open';\nfor (i = 0; i < msgdata.length; i++) // look for the word sub\n    { \n    if (msgdata[i] == \"sub\")\n        {\n        subwoofer_found = 1; // found sub word\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word woofer\n    { \n    if (msgdata[i] == \"woofer\")\n        {\n        subwoofer_found = 1; // found sub word\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word subwoofer\n    { \n    if (msgdata[i] == \"subwoofer\")\n        {\n        subwoofer_found = 1; // found sub woofer word\n        }\n    }\nif (subwoofer_found)\n    {\n    for (i = 0; i < msgdata.length; i++) // look for the word on with subwoofer\n        { \n        if (msgdata[i] == \"on\")\n            {\n            var subwoofer_mode = 1; // found on word\n            node.send ({payload:[\"sub woofer on\"]}); // send string to AMX\n            }\n        }\n    for (i = 0; i < msgdata.length; i++) // look for the word off with subwoofer\n        { \n        if (msgdata[i] == \"off\")\n            {\n            var subwoofer_mode = 0; // found off word\n            node.send ({payload:[\"sub woofer off\"]}); // send string to AMX\n            }\n        }\n    }\nreturn null;","outputs":1,"noerr":0,"x":470,"y":254,"wires":[[]]},{"id":"e1e3b86c.b62008","type":"inject","z":"9ee7463e.23def8","name":"Sub Woofer Off","topic":"","payload":"sub woofer off","payloadType":"str","repeat":"","crontab":"","once":false,"x":141,"y":151,"wires":[["b91e72eb.efd7a"]]},{"id":"de808303.ce913","type":"link out","z":"9ee7463e.23def8","name":"From Lounge Room Controls","links":["5218ba8d.aa04a4"],"x":1130,"y":182,"wires":[]},{"id":"ad6eb457.7bc928","type":"link out","z":"9ee7463e.23def8","name":"Send to AMX","links":["95cce6d5.27ac38"],"x":855,"y":113,"wires":[]},{"id":"32c2a875.3373a8","type":"inject","z":"9ee7463e.23def8","name":"Sub Woofer On","topic":"","payload":"sub woofer on","payloadType":"str","repeat":"","crontab":"","once":false,"x":162,"y":43,"wires":[["223d409d.1217d"]]},{"id":"beaac551.75bc38","type":"function","z":"9ee7463e.23def8","name":"Extract Sub Woofer Controls","func":"var msgdata = msg.payload.split(\" \");\nvar newMsg = {};\nnewMsg.topic = \"Sub Woofer Controls\";\nvar datalength = msgdata.length;\nvar subwoofer_found = 0;\n//var door_mode = 'open';\nfor (i = 0; i < msgdata.length; i++) // look for the word sub\n    { \n    if (msgdata[i] == \"sub\")\n        {\n        subwoofer_found = 1; // found sub word\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word woofer\n    { \n    if (msgdata[i] == \"woofer\")\n        {\n        subwoofer_found = 1; // found sub word\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word subwoofer\n    { \n    if (msgdata[i] == \"subwoofer\")\n        {\n        subwoofer_found = 1; // found sub woofer word\n        }\n    }\nif (subwoofer_found)\n    {\n    for (i = 0; i < msgdata.length; i++) // look for the word on with subwoofer\n        { \n        if (msgdata[i] == \"on\")\n            {\n            var subwoofer_mode = 1; // found on word\n            node.send ({payload:[\"sub woofer on\"]}); // send string to AMX\n            }\n        }\n    for (i = 0; i < msgdata.length; i++) // look for the word off with subwoofer\n        { \n        if (msgdata[i] == \"off\")\n            {\n            var subwoofer_mode = 0; // found off word\n            node.send ({payload:[\"sub woofer off\"]}); // send string to AMX\n            }\n        }\n    }\nreturn null;","outputs":1,"noerr":0,"x":402,"y":96,"wires":[["ad6eb457.7bc928","4135ba5b.85c6a4"]]},{"id":"4135ba5b.85c6a4","type":"function","z":"9ee7463e.23def8","name":"Siri Said","func":"var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\nnewMsg = \"Siri said\";\nnode.send ({payload:newMsg});\nsleep (500);\nnewMsg = \"sub woofer\";\nnode.send ({payload:newMsg});\nsleep (250);\n    \nif (newWord == \"sub woofer on\")\n    {\n    newMsg = \"on\";\n    node.send ({payload:newMsg});\n    }\nif (newWord == \"sub woofer off\")\n    {\n    newMsg = \"off\";\n    node.send ({payload:newMsg});\n    }\nreturn null;","outputs":1,"noerr":0,"x":645,"y":231,"wires":[["7cec72d4.3a66fc","de808303.ce913"]]},{"id":"d59d44c9.358a88","type":"function","z":"9ee7463e.23def8","name":"Sub Woofer On","func":"var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n\nnewMsg = \"sub woofer\";\nnode.send ({payload:newMsg});\nsleep (250);\nnewMsg = \"on\";\nnode.send ({payload:newMsg});\nreturn null;","outputs":1,"noerr":0,"x":885,"y":53,"wires":[["de808303.ce913"]]},{"id":"5a352fa4.44a15","type":"link in","z":"9ee7463e.23def8","name":"Receive Siri Data","links":["3a083f00.0e1a52"],"x":149,"y":101,"wires":[["beaac551.75bc38"]]},{"id":"5fa46e03.1828e","type":"function","z":"9ee7463e.23def8","name":"Sub Woofer Off","func":"var newWord = msg.payload.toString();\nvar newMsg;\n\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n\nnewMsg = \"sub woofer\";\nnode.send ({payload:newMsg});\nsleep (250);\nnewMsg = \"off\";\nnode.send ({payload:newMsg});\nreturn null;","outputs":1,"noerr":0,"x":866,"y":155,"wires":[["de808303.ce913"]]},{"id":"1f02a526.1ce6cb","type":"ui_group","z":"","name":"Sub Woofer","tab":"a3214798.c475a8","disp":true,"width":"3"},{"id":"a3214798.c475a8","type":"ui_tab","z":"","name":"Onkyo Amp","icon":"dashboard","order":10}]