[{"id":"8d19e89f.5b2088","type":"ui_button","z":"a575df46.6c9c","name":"Voice Control On","group":"7d3d52dc.b9997c","order":0,"width":"3","height":"1","passthru":true,"label":"Voice On","color":"","bgcolor":"","icon":"","payload":"voice control on","payloadType":"str","topic":"","x":410,"y":80,"wires":[["95bfa212.69db1","bd48ad2a.90c5c"]]},{"id":"8d5f3849.5614f8","type":"inject","z":"a575df46.6c9c","name":"Voice Control Off","topic":"","payload":"voice control off","payloadType":"str","repeat":"","crontab":"","once":false,"x":200,"y":200,"wires":[["c5571e98.83cf6"]]},{"id":"e214bdb7.db89e","type":"debug","z":"a575df46.6c9c","name":"","active":false,"console":"false","complete":"false","x":650,"y":220,"wires":[]},{"id":"c5571e98.83cf6","type":"ui_button","z":"a575df46.6c9c","name":"Voice Control Off","group":"7d3d52dc.b9997c","order":0,"width":"3","height":"1","passthru":true,"label":"Voice Off","color":"","bgcolor":"","icon":"","payload":"voice control off","payloadType":"str","topic":"","x":410,"y":200,"wires":[["95bfa212.69db1","bd48ad2a.90c5c","e214bdb7.db89e"]]},{"id":"bd48ad2a.90c5c","type":"debug","z":"a575df46.6c9c","name":"","active":false,"console":"false","complete":"false","x":650,"y":80,"wires":[]},{"id":"95bfa212.69db1","type":"function","z":"a575df46.6c9c","name":"Set Voice Control","func":"//var voice_message_reject = context.get('voice')||0; // initialise the voice to 1 if it doesn't exist already\nvar voice_message_reject = 0;\nvar newMsg = {};\nvar msgdata = msg.payload.split(\":\");\nnewMsg = msg.payload;\nvoice_message_reject = 0;\nvar voice_control = context.get('control')||0; // initialise the counter to 1 if it doesn't exist already\n\nvar datalength = msgdata.length;\n\nfor (i = 0; i < msgdata.length; i++) // look for the word ACZONES\n    { \n    if (msgdata[i] == \"ACZONES\")\n        {\n        voice_message_reject = 1;\n        var voice_message = \"reject on for AC Zones\";\n        //node.send ({payload:voice_message});\n        }\n    }\nfor (i = 0; i < msgdata.length; i++) // look for the word TEMPS\n    { \n    if (msgdata[i] == \"TEMPS\")\n        {\n        voice_message_reject = 1;\n        var voice_message = \"reject on for TEMPS\";\n        //node.send ({payload:voice_message});\n        }\n    }\n\n//for (i = 0; i < msgdata.length; i++) // look for the word Voice Control On\n//    { \n//    if (msgdata[i] == \"voice control on\")\n//        {\n//        voice_control = 1;\n//        //context.set('voice',voice_message_reject);\n//        var voice_message = \"voice control on\";\n//        node.send ({payload:voice_message});\n//        }\n//    }\n//for (i = 0; i < msgdata.length; i++) // look for the word Voice Control Off\n//    { \n//    if (msgdata[i] == \"voice control off\")\n//        {\n//        voice_control = 0;\n//        //context.set('voice',voice_message_reject);\n//        var voice_message = \"voice control off\";\n//        node.send ({payload:voice_message});\n//        }\n//    }\n\nif (newMsg ==\"voice control on\")\n    {\n    voice_control = 1;    \n    }\nif (newMsg ==\"voice control off\")\n    {\n    voice_control = 0;\n    }\n// store the value back\ncontext.set('control',voice_control);\n\nif (voice_control)\n    {\n    if (!voice_message_reject)\n        {\n        // make it part of the outgoing msg object\n        node.send ({payload:voice_control});\n        node.send ({payload:voice_message});\n        node.send ({payload:msg.payload});\n        }\n    }\n\nreturn null;","outputs":1,"noerr":0,"x":710,"y":140,"wires":[["f8ed5b40.ea82f8","d8ded908.338958"]]},{"id":"d8ded908.338958","type":"debug","z":"a575df46.6c9c","name":"","active":false,"console":"false","complete":"false","x":950,"y":180,"wires":[]},{"id":"5218ba8d.aa04a4","type":"link in","z":"a575df46.6c9c","name":"To Voice","links":["a4aec681.3c59b8","20230df9.d33662","de808303.ce913","f32d8aa5.cd93b8","cbe192d6.99bad","86568e1b.6b04f","294c21df.288d3e","b56a84de.122758","85437bfe.0cafd8","b953418c.b412d","e0e1564d.9e2cc8","3b4b7ff1.4d599"],"x":255,"y":140,"wires":[["95bfa212.69db1"]]},{"id":"ad6a8026.9d67b","type":"inject","z":"a575df46.6c9c","name":"Voice Control On","topic":"","payload":"voice control on","payloadType":"str","repeat":"","crontab":"","once":false,"x":200,"y":80,"wires":[["8d19e89f.5b2088"]]},{"id":"f8ed5b40.ea82f8","type":"play audio","z":"a575df46.6c9c","name":"Play Relay Sound","voice":"0","x":970,"y":140,"wires":[]},{"id":"7d3d52dc.b9997c","type":"ui_group","z":"","name":"Voice Control","tab":"35324a4d.8dae86","disp":true,"width":"6"},{"id":"35324a4d.8dae86","type":"ui_tab","z":"","name":"Engineering","icon":"dashboard","order":17}]